---
title: 18.3.16周记
date: 2018-03-16 13:02:57
tags: 周记
---
## 周记系列
打算专门开一个tag叫做周记：做一个每周的积累回顾。
周记目前的定位主要在三个方面：
1. 工作中的经验总结
2. 自己实践中的经验总结
3. 阅读和学习的总结

## 工作
实习渐渐经过了熟悉期，开始把一些经验慢慢积累到博客里。
#### 创建了一种能够使安卓手机正常显示12px以下或奇数2倍px字体的hack
{% codeblock lang:jsx %}
import React from 'react'
import { isAndroid } from '~/lib/userAgent'
/*
* 修正安卓系统小于12px字体,奇数2倍像素大小字体垂直居中问题
* 暂不支持换行
*/

const FontSizeShim = ({ children }) =>
  isAndroid ? (
    <div>
      <span className="FontSizeShimContent">{children}</span>
      <style jsx>{`
        .FontSizeShimContent::before {
          position: absolute;
          font-size: 4em;
          transform: scale(0.25);
          transform-origin: top left;
          content: '${children}';
          white-space:nowrap;
          visibility: visible;
        }
        .FontSizeShimContent {
          position: relative;
          visibility: hidden;
        }
      `}</style>
    </div>
  ) : (
    <span>{children}</span>
  )

export default FontSizeShim

{% endcodeblock%}

#### 一些经验积累
性能优化方面：
1. 频繁触发事件应当使用函数节流，相关的库有`throttle`等。
2. `React`中与`render()`无关的方法应抽出到类中，避免重复渲染。

代码风格方面：
1. 变量命名应当符合英语语法，例如`isSomethingVisible`或`showSomething`。
2. 类方法之间应当空行。
3. 可以用空行来辅助区分代码块。
4. 避免重复的语义在统一块代码中出现，比如`isSomethingVisible`和`showSomething`。

排错经验方面：
1. 设置`webpack`的`sourcemap`。
2. 对于`something1.something2.something3`这种类型的对象属性调用应该谨慎，否则当`something2`不存在时直接调用会报错。处理这种情况的方式有逐级排查或者使用`lodash/get`之类的库辅助检测。

## 实践
这周主要用node写了个命令行工具，用于在 Github Pages 上快速部署自己的项目。
链接在这里： [git-deployer](https://www.npmjs.com/package/git-deployer)。
主要原理就是将指定文件夹的内容拷贝进入一个新文件夹，再将新文件夹的`git remote`设置为指定的地址，进行`force push`。
另外写了个纪念比利王的网站，优化了music和主站的code，就不细说了吧。

另外在自己的`bandwagonHost`上面尝试了用`express`脚本结合`githooks`自动部署代码，原理就是`github`自动post一个请求到我的服务器，然后我的服务器收到对应请求之后执行相应的shell脚本。

## 阅读
最近在阅读《代码大全》。